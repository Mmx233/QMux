# QMux Server Configuration
# Generated by: qmux generate config server

# Listener configuration
# Each listener defines a QUIC endpoint that accepts client connections
listeners:
  # Address for QUIC control connections (IP:port format)
  - quic_addr: "0.0.0.0:8443"

    # Address for forwarded traffic (IP:port format, 1:1 mapped to this listener)
    traffic_addr: "0.0.0.0:8080"

    # Protocol to accept: "tcp", "udp", or "both"
    protocol: "both"

    # QUIC settings (optional - defaults are used if not specified)
    # Initial stream receive window size in bytes
    # initialstreamreceivewindow: 524288

    # Maximum stream receive window size in bytes
    # maxstreamreceivewindow: 6291456

    # Initial connection receive window size in bytes
    # initialconnectionreceivewindow: 1048576

    # Maximum connection receive window size in bytes
    # maxconnectionreceivewindow: 15728640

    # Maximum number of incoming streams
    # maxincomingstreams: 100

    # Keep-alive period for the connection
    # keepaliveperiod: 30s

    # Timeout for the handshake to complete
    # handshakeidletimeout: 10s

    # Maximum idle timeout before connection is closed
    # maxidletimeout: 5m

    # Allow 0-RTT connections (reduces latency but has security implications)
    # allow0rtt: false

# Authentication configuration
auth:
  # Authentication method: "mtls" (mutual TLS) or "token"
  method: "mtls"

  # Path to CA certificate file (for client verification in mTLS mode)
  ca_cert_file: "./certs/ca.crt"

  # Token for challenge-response authentication (required when method is "token")
  # token: "my-secret-token-at-least-16-bytes"

# TLS configuration
tls:
  # Path to server certificate file
  server_cert_file: "./certs/server.crt"

  # Path to server private key file
  server_key_file: "./certs/server.key"

  # Session ticket encryption key rotation (optional)
  # Rotation interval for session ticket encryption keys
  # Recommended: 24h for production, 0 to disable rotation
  # session_ticket_encryption_key_rotation_interval: 24h

  # Number of keys to maintain during rotation (current + old keys)
  # Recommended: 2-3 for smooth rotation
  # session_ticket_encryption_key_rotation_overlap: 2

# Health check settings
# How often to check client health
health_check_interval: 10s

# Time without heartbeat before marking client as unhealthy
health_check_timeout: 30s
